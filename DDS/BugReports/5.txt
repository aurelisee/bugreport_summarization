Issue Type: <b>Bug</b>
When having Python interactive window open and try to switch to that group (normally with Cmd + 2), the cursor will disappear instead of going to the "command line" (the space to write commands)
Then when trying to go back to editor with Cmd + 1, this won\'t work again so I need to use the mouse to click where I want to go
This is happening since the last update
It\'s important to mention that this problem is exclusive for Python Interactive
When using editors, it works fine
VS Code version: Code 1.45.1 (5763d909d5f12fe19f215cbfdd29a91c0fa9208a, 2020-05-14T08:33:47.663Z)
OS version: Darwin x64 19.4.0
<details>
<summary>System Info</summary>
|Item|Value|
|---|---|
|CPUs|Intel(R) Core(TM) i5-5257U CPU @ 2.70GHz (4 x 2700)|
|GPU Status|2d_canvas: enabled
flash_3d: enabled
flash_stage3d: enabled
flash_stage3d_baseline: enabled
gpu_compositing: enabled
metal: disabled_off
multiple_raster_threads: enabled_on
oop_rasterization: disabled_off
protected_video_decode: unavailable_off
rasterization: enabled
skia_renderer: disabled_off_ok
video_decode: enabled
viz_display_compositor: enabled_on
viz_hit_test_surface_layer: disabled_off_ok
webgl: enabled
webgl2: enabled|
|Load (avg)|1, 2, 2|
|Memory (System)|8.00GB (1.19GB free)|
|Process Argv|.|
|Screen Reader|no|
|VM|0%|
</details><details><summary>Extensions (2)</summary>
Extension|Author (truncated)|Version
---|---|---
python|ms-|2020.5.78807
vim|vsc|1.14.3
</details>
<!-- generated by issue reporter -->
Sounds like a `webview` issue to me
Maybe caused by extension, not sure.
I'm not sure
I disabled the extensions but this kept happening
I had to go back to version 1.44.2 for it to work again
- VSCode Version: 1.45.1-1589445302 and 1.46.0-1590182489 (insiders)
- OS Version: Ubuntu MATE 20.04
Steps to Reproduce:
1. Save [this](https://raw.githubusercontent.com/saveriomiroddi/personal_notes/f6af9dce9cebe479c9f17d80a5c758746cb68dd7/debian_packaging_ppas.md) file locally (it happens also with other files; this is a file I\'ve been able to reproduce it consistently with)
2. Launch VSC
3. Open the file above
4. Tap Ctrl+K, V
5. Now, perform the following sequence without leaving the finger from Ctrl:   - Ctrl + 1, Ctrl + End, Ctrl + 2, Ctrl + W
6. The keyboard is now locked! Tapping any key/combination doesn\'t have any effect.
I don\'t know if the "without leaving the finger" part is voodoo or it\'s real, but reproducing the bug consistently has been hell enough :-)
With the above procedure, I can reproduce it almost all the times with at most 3 attempts
If the bug doesn\'t happen, close the preview, move the file cursor to the top of the file, and restart from 4.
Does this issue occur when all extensions are disabled?: Yes
I\'ve also tested with a wiped configuration directory.
By default, `ctrl+k v` is bound to `markdown.showPreviewToSide`, so I believe this is about keybindings not working when the webview has focus.
Also related to #97992
Hi, I would like to look further into this
Is there anyone else working on it?
Duplicate of #97992
Also see Chromium issue: https://bugs.chromium.org/p/chromium/issues/detail?id=1144999
Hi @mjbvz ðŸ‘‹ I work on the Python extension data science team
We've had multiple users report this issue on our repo: [#11808](https://github.com/microsoft/vscode-python/issues/11808) and [#12088](https://github.com/microsoft/vscode-python/issues/12088).
This bug does not manifest with 1.44.2 and the latest release of our Python extension (2020.5.80290)
In ^1.45, it appears that our webview within the panel doesn't receive focus when the user switches to a group containing it using the Ctrl+1/2 keyboard shortcut
Specifically, `focus` fires when the user directly clicks on the webview, but not with the keyboard shortcuts.
Would you happen to have an idea of when / how this can be fixed, and any workarounds we can use in the interim to ensure our webview receives focus with keyboard shortcuts?
@joyceerhl Are any other keyboard shortcut not working?
I've only been testing switching groups since that's what users reported an issue with, so just Ctrl+1/2/3 etc
Sorry if my original comment was ambiguous!
This is a lower priority issue since those keyboard short cuts are not super heavily used.
It sounds like the core of https://github.com/microsoft/vscode-python/issues/11808 is that focus is not restored once the interactive window is refocused
I can repo this just by clicking away from the python interactive window and then clicking on the interactive window tab
I believe that needs to be fixed in the interactive window's implementation
Just to be sure I understandâ€”you're recommending that when the webview panel is focused, we should also explicitly focus the webview
Could you point me to docs for managing focus changes for webview panels
As far as we know, we don't have sufficient information to determine when to correctly give focus to ourselves without stealing focus when we shouldn't (the active state on the webview panel is not accurate).
This is up to your extension
When a webview tab is focused, VS Code focused the webview element but it does not restore focus to any previously focused element within that webview
In your webview, you can just use:
```js
window.addEventListener('focus', () => { });
window.addEventListener('blur', () => { });
```
to detect when focus is gained or lost
Will give that a try
Thank you!
For #11808
## Gif demonstrating fix
![ezgif-4-2bd1cdfa747f](https://user-images.githubusercontent.com/30305945/83308126-fbe06e80-a1ba-11ea-8754-f6d2b5d44d3e.gif)
<!--
  If an item below does not apply to you, then go ahead and check it off as "done" and strikethrough the text, e.g.:
    - [x] ~Has unit tests & system/integration tests~
-->
-   [x] Pull request represents a single change (i.e
not fixing disparate/unrelated things in a single PR).
-   [x] Title summarizes what is changing.
-   [x] Has a [news entry](https://github.com/Microsoft/vscode-python/tree/master/news) file (remember to thank yourself!).
-   [x] Appropriate comments and documentation strings in the code.
~-   [ ] Has sufficient logging.~
~-   [ ] Has telemetry for enhancements.~
-   [x] Unit tests & system/integration tests are added/updated.
-   [ ] [Test plan](https://github.com/Microsoft/vscode-python/blob/master/.github/test_plan.md) is updated as appropriate.
~-   [ ] [`package-lock.json`](https://github.com/Microsoft/vscode-python/blob/master/package-lock.json) has been regenerated by running `npm install` (if dependencies have changed).~
~-   [ ] The wiki is updated with any design decisions/details.~
Hi @mjbvz, I added listeners for `focus` and `blur` events on the window itself, and forced a focus on the input box when `window` receives focus
This did not resolve the issue.
Based on logging in the window focus / blur callbacks, it appears that if I select, unselect, then reselect the interactive window using keyboard shortcuts, on reselect, the webview window gets `focus` immediately followed by `blur`, which is what results in the interactive window becoming unresponsive
This still manifests after stripping out all the places in our codebase where we manually focus elements
We do not get the extra `blur` event if we click directly on the panel tab.
For this reason I think this bug is a result of a change in keyboard shortcut handling, and listening for `focus` / `blur` on the window is insufficient, since we're getting an extra `blur` external to our code
Would you be able to suggest any workarounds we can implement while the keyboard shortcut issue is being resolved
@joyceerhl I see that a focus event is always fired last:
![Jun-04-2020 13-06-47](https://user-images.githubusercontent.com/12821956/83805202-49018c00-a664-11ea-99c5-f242687f3db0.gif)
It looks like there is an extra `blur` in between but the focus remains the last callback
